---
title: "Project"
author: "P.K"
date: "2022-11-02"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r, warning=FALSE, message=FALSE}

# Generalized the path

library(readr)
training_set <- read_csv("train.csv")

testing_set <- read_csv("test_new.csv")

```

Scatterplots

```{r}
summary(training_set)
pairs(training_set[,c(4,5,20,21,27)])
pairs(training_set[,c(35,37,38,39)])
pairs(training_set[,c(44:48)])
pairs(training_set[,c(48:53)])
pairs(training_set[,c(55,57,60,62,63)])
pairs(training_set[,c(67:71)])
pairs(training_set[,c(72,76:78)])

pairs(training_set[,c(4,5,27,35,44,63,67)])
```

Boxplots

```{r}
plot(y=training_set$SalePrice, x=as.factor(training_set$MSSubClass))
plot(y=training_set$SalePrice, x=as.factor(training_set$MSZoning))
plot(y=training_set$SalePrice, x=as.factor(training_set$LotShape))
plot(y=training_set$SalePrice, x=as.factor(training_set$Utilities))
plot(y=training_set$SalePrice, x=as.factor(training_set$LandSlope))
plot(y=training_set$SalePrice, x=as.factor(training_set$Neighborhood))
plot(y=training_set$SalePrice, x=as.factor(training_set$Condition1))
plot(y=training_set$SalePrice, x=as.factor(training_set$BldgType))
plot(y=training_set$SalePrice, x=as.factor(training_set$HouseStyle))
plot(y=training_set$SalePrice, x=as.factor(training_set$OverallQual))
plot(y=training_set$SalePrice, x=as.factor(training_set$OverallCond))
plot(y=training_set$SalePrice, x=as.factor(training_set$RoofStyle))
plot(y=training_set$SalePrice, x=as.factor(training_set$ExterQual))
plot(y=training_set$SalePrice, x=as.factor(training_set$Foundation))
plot(y=training_set$SalePrice, x=as.factor(training_set$BsmtCond))
plot(y=training_set$SalePrice, x=as.factor(training_set$Heating))
plot(y=training_set$SalePrice, x=as.factor(training_set$CentralAir))
plot(y=training_set$SalePrice, x=as.factor(training_set$KitchenQual))
plot(y=training_set$SalePrice, x=as.factor(training_set$GarageQual))
plot(y=training_set$SalePrice, x=as.factor(training_set$SaleType))
plot(y=training_set$SalePrice, x=as.factor(training_set$SaleCondition))
```


```{r}

# Ethan's Work
library(MASS)
library(dplyr)
library(tidyr)
library(tibble)
library(reshape2)

# Data is skewed
fit <- fitdistr(training_set$SalePrice, "normal")
para <- fit$estimate
x <- rnorm(1000, para[1],para[2])
hist(training_set$SalePrice, prob = TRUE, breaks = 50, xlab = "Sale Price ($)", ylab = "Density")
curve(dnorm(x,para[1],para[2]), col = 2, add = TRUE)


# Need to reduce dimensions. Likely good to get rid of redundant and correlated 
# variables.

num_train <- Filter(is.numeric, training_set)
num_train <- na.omit(num_train)

cor_mat <- round(cor(num_train),2)

# Correlations limited to combinations >= .60
cor_mat[!lower.tri(cor_mat)] <- NA # remove diagonal and redundant values

cor_mat <- data.frame(cor_mat) %>%
              rownames_to_column() %>%
              gather(key="variable", value="correlation", -rowname) %>%
              filter(abs(correlation) >= 0.6)

# Heat map for correlations
cc <- round(cor(num_train),2)
threshold <- 0.6
cc0 <- cc
diag(cc0) <- 0
ok <- apply(abs(cc0) >= threshold, 1, any)
cc <- cc[ok, ok]



# reduce the size of correlation matrix
melted_corr_mat <- melt(cc)

# plotting the correlation heatmap
library(ggplot2)
ggplot(data = melted_corr_mat, aes(x=Var1, y=Var2,
                                   fill=value)) +
geom_tile() +
geom_text(aes(Var1, Var2, label = value),
          color = "black", size = 3) +
   theme(axis.text.x=element_text(angle=90,hjust=1,vjust=0.5)) +
  scale_fill_gradient(low = "#ffffff", high = "#ff0000", guide = "colorbar")
```
